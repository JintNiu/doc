# 模型的实现

## 数据库设计

建立物理数据模型（physical data model, PDM）

任务：

* 建立哪些表
* 表中有哪些字段
* 表的主键和外键是什么
* 字段的数据类型以及约束

* 一个实体可以映射为一个数据库表
* 使用词汇表统一表名和属性名
* 主键。primary key，PK
* 审计字段：创建时间 created_at，创建人 created_by，最后一次修改时间 last_updated_at 和 最后一次修改人 last_updated_by
* 实线箭头：外键参照关系。
* 虚拟外键（虚线表示）：在基于云的应用里，为了减少数据库处理的瓶颈，一般不主张建立真正的外键，而是用程序来保证外键约束。
* 外键：foreign key，FK
* 联合主键：
  * 两个外键字段唯一决定了一条记录
  * 这个表的主键没有被其他表作为外键引用
* 

![](https://static001.geekbang.org/resource/image/57/67/5722f6e5abd44822409f31ff0ee2f667.jpg?wh=3733x2260)

## 与以前方法的区别

### 拍脑袋法
面向技术人员的，业务专家很难理解，很难保证数据库设计能准确地反映领域知识
很可能会违反数据库设计的范式（NF），造成数据冗余和潜在错误。


### ER图法

按照“概念设计”“逻辑设计”和“物理设计”的步骤进行数据库设计

DDD 中的物理数据模型图不是 ER 图

* 采用 UML 类图描述的领域模型图是 ER 图的超集
* ER 图只能表达静态的数据关系，只用于数据库设计，而领域模型图则可以将静态数据和动态行为绑定，不仅可以用于数据库设计，还可以用于程序设计
* 层次和使用场合不一样：领域模型对应的主要是传统软件工程的分析模型，而 ER 图在传统软件工程里则处于设计阶段